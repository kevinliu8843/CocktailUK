<% 
Class CStopWord
	Private m_aryStopWords
	Public Sub Class_Initialize
		Redim m_aryStopWords(394)
		Call AddAllWords()
	End Sub

	Public Function IsStopWord(strWord)
		' strWord must be in lowercase for this to work
		' Use a binary Search to determine the word status
		Dim intStart, intMiddle, intEnd

		intStart	= 0
		intEnd		= UBound(m_aryStopWords)
		intMiddle	= (intEnd - intStart) \ 2

		Do While True
	
			If strWord = m_aryStopWords(intMiddle) Then
				IsStopWord = True
				Exit Function
			ElseIf strWord < m_aryStopWords(intMiddle) Then
				intEnd		= intMiddle-1
				If (intMiddle - intStart) > 1 Then
					intMiddle	= intStart + ((intEnd - intStart) \ 2)
				ElseIf (intMiddle - intStart) = 1 Then
					intMiddle	= intStart
				Else
					IsStopWord = False
					Exit Function
				End If
			Else
				intStart	= intMiddle+1
				If (intEnd - intMiddle) > 1 Then
					intMiddle	= intStart + ((intEnd - intStart) \ 2)
				ElseIf (intEnd - intMiddle) = 1 Then
					intMiddle	= intEnd
				Else
					IsStopWord = False
					Exit Function
				End If
			End If
		Loop
	End Function

	Private Sub AddAllWords()
		' These must stay in order!
		m_aryStopWords(0) = "and"
		m_aryStopWords(1) = "not"
		m_aryStopWords(2) = "or"
		exit sub
		m_aryStopWords(0) = "a"
		m_aryStopWords(1) = "about"
		m_aryStopWords(2) = "above"
		m_aryStopWords(3) = "according"
		m_aryStopWords(4) = "accordingly"
		m_aryStopWords(5) = "across"
		m_aryStopWords(6) = "adj"
		m_aryStopWords(7) = "after"
		m_aryStopWords(8) = "afterward"
		m_aryStopWords(9) = "afterwards"
		m_aryStopWords(10) = "again"
		m_aryStopWords(11) = "against"
		m_aryStopWords(12) = "albeit"
		m_aryStopWords(13) = "all"
		m_aryStopWords(14) = "almost"
		m_aryStopWords(15) = "alone"
		m_aryStopWords(16) = "along"
		m_aryStopWords(17) = "already"
		m_aryStopWords(18) = "also"
		m_aryStopWords(19) = "although"
		m_aryStopWords(20) = "always"
		m_aryStopWords(21) = "among"
		m_aryStopWords(22) = "amongst"
		m_aryStopWords(23) = "an"
		m_aryStopWords(24) = "and"
		m_aryStopWords(25) = "another"
		m_aryStopWords(26) = "any"
		m_aryStopWords(27) = "anyhow"
		m_aryStopWords(28) = "anyone"
		m_aryStopWords(29) = "anything"
		m_aryStopWords(30) = "anywhere"
		m_aryStopWords(31) = "apart"
		m_aryStopWords(32) = "apparently"
		m_aryStopWords(33) = "are"
		m_aryStopWords(34) = "arise"
		m_aryStopWords(35) = "around"
		m_aryStopWords(36) = "as"
		m_aryStopWords(37) = "aside"
		m_aryStopWords(38) = "at"
		m_aryStopWords(39) = "away"
		m_aryStopWords(40) = "be"
		m_aryStopWords(41) = "became"
		m_aryStopWords(42) = "because"
		m_aryStopWords(43) = "become"
		m_aryStopWords(44) = "becomes"
		m_aryStopWords(45) = "becoming"
		m_aryStopWords(46) = "been"
		m_aryStopWords(47) = "before"
		m_aryStopWords(48) = "beforehand"
		m_aryStopWords(49) = "began"
		m_aryStopWords(50) = "behind"
		m_aryStopWords(51) = "being"
		m_aryStopWords(52) = "below"
		m_aryStopWords(53) = "beside"
		m_aryStopWords(54) = "besides"
		m_aryStopWords(55) = "between"
		m_aryStopWords(56) = "beyond"
		m_aryStopWords(57) = "both"
		m_aryStopWords(58) = "briefly"
		m_aryStopWords(59) = "but"
		m_aryStopWords(60) = "by"
		m_aryStopWords(61) = "came"
		m_aryStopWords(62) = "can"
		m_aryStopWords(63) = "cannot"
		m_aryStopWords(64) = "certain"
		m_aryStopWords(65) = "certainly"
		m_aryStopWords(66) = "co"
		m_aryStopWords(67) = "consequently"
		m_aryStopWords(68) = "could"
		m_aryStopWords(69) = "despite"
		m_aryStopWords(70) = "did"
		m_aryStopWords(71) = "different"
		m_aryStopWords(72) = "do"
		m_aryStopWords(73) = "does"
		m_aryStopWords(74) = "done"
		m_aryStopWords(75) = "down"
		m_aryStopWords(76) = "due"
		m_aryStopWords(77) = "during"
		m_aryStopWords(78) = "each"
		m_aryStopWords(79) = "eg"
		m_aryStopWords(80) = "either"
		m_aryStopWords(81) = "else"
		m_aryStopWords(82) = "elsewhere"
		m_aryStopWords(83) = "enough"
		m_aryStopWords(84) = "especially"
		m_aryStopWords(85) = "etc"
		m_aryStopWords(86) = "etc"
		m_aryStopWords(87) = "even"
		m_aryStopWords(88) = "eventually"
		m_aryStopWords(89) = "ever"
		m_aryStopWords(90) = "every"
		m_aryStopWords(91) = "everyone"
		m_aryStopWords(92) = "everything"
		m_aryStopWords(93) = "everywhere"
		m_aryStopWords(94) = "example"
		m_aryStopWords(95) = "except"
		m_aryStopWords(96) = "few"
		m_aryStopWords(97) = "fewer"
		m_aryStopWords(98) = "finally"
		m_aryStopWords(99) = "find"
		m_aryStopWords(100) = "first"
		m_aryStopWords(101) = "following"
		m_aryStopWords(102) = "for"
		m_aryStopWords(103) = "former"
		m_aryStopWords(104) = "formerly"
		m_aryStopWords(105) = "found"
		m_aryStopWords(106) = "from"
		m_aryStopWords(107) = "further"
		m_aryStopWords(108) = "furthermore"
		m_aryStopWords(109) = "gave"
		m_aryStopWords(110) = "generally"
		m_aryStopWords(111) = "get"
		m_aryStopWords(112) = "gets"
		m_aryStopWords(113) = "give"
		m_aryStopWords(114) = "given"
		m_aryStopWords(115) = "gives"
		m_aryStopWords(116) = "giving"
		m_aryStopWords(117) = "gone"
		m_aryStopWords(118) = "got"
		m_aryStopWords(119) = "had"
		m_aryStopWords(120) = "had"
		m_aryStopWords(121) = "hardly"
		m_aryStopWords(122) = "has"
		m_aryStopWords(123) = "have"
		m_aryStopWords(124) = "having"
		m_aryStopWords(125) = "he"
		m_aryStopWords(126) = "hence"
		m_aryStopWords(127) = "henceforth"
		m_aryStopWords(128) = "her"
		m_aryStopWords(129) = "here"
		m_aryStopWords(130) = "hereafter"
		m_aryStopWords(131) = "hereby"
		m_aryStopWords(132) = "herein"
		m_aryStopWords(133) = "hereupon"
		m_aryStopWords(134) = "hers"
		m_aryStopWords(135) = "herself"
		m_aryStopWords(136) = "him"
		m_aryStopWords(137) = "himself"
		m_aryStopWords(138) = "his"
		m_aryStopWords(139) = "how"
		m_aryStopWords(140) = "however"
		m_aryStopWords(141) = "i"
		m_aryStopWords(142) = "i'm"
		m_aryStopWords(143) = "ie"
		m_aryStopWords(144) = "if"
		m_aryStopWords(145) = "immediately"
		m_aryStopWords(146) = "in"
		m_aryStopWords(147) = "inc"
		m_aryStopWords(148) = "include"
		m_aryStopWords(149) = "included"
		m_aryStopWords(150) = "includes"
		m_aryStopWords(151) = "including"
		m_aryStopWords(152) = "indeed"
		m_aryStopWords(153) = "instead"
		m_aryStopWords(154) = "into"
		m_aryStopWords(155) = "is"
		m_aryStopWords(156) = "it'll"
		m_aryStopWords(157) = "it"
		m_aryStopWords(158) = "its"
		m_aryStopWords(159) = "itself"
		m_aryStopWords(160) = "just"
		m_aryStopWords(161) = "keep"
		m_aryStopWords(162) = "kept"
		m_aryStopWords(163) = "largely"
		m_aryStopWords(164) = "last"
		m_aryStopWords(165) = "later"
		m_aryStopWords(166) = "latter"
		m_aryStopWords(167) = "latterly"
		m_aryStopWords(168) = "le"
		m_aryStopWords(169) = "least"
		m_aryStopWords(170) = "less"
		m_aryStopWords(171) = "like"
		m_aryStopWords(172) = "ltd"
		m_aryStopWords(173) = "made"
		m_aryStopWords(174) = "mainly"
		m_aryStopWords(175) = "make"
		m_aryStopWords(176) = "many"
		m_aryStopWords(177) = "may"
		m_aryStopWords(178) = "maybe"
		m_aryStopWords(179) = "me"
		m_aryStopWords(180) = "meanwhile"
		m_aryStopWords(181) = "might"
		m_aryStopWords(182) = "miss"
		m_aryStopWords(183) = "more"
		m_aryStopWords(184) = "moreover"
		m_aryStopWords(185) = "most"
		m_aryStopWords(186) = "mostly"
		m_aryStopWords(187) = "much"
		m_aryStopWords(188) = "mug"
		m_aryStopWords(189) = "must"
		m_aryStopWords(190) = "my"
		m_aryStopWords(191) = "myself"
		m_aryStopWords(192) = "namely"
		m_aryStopWords(193) = "near"
		m_aryStopWords(194) = "nearly"
		m_aryStopWords(195) = "necessarily"
		m_aryStopWords(196) = "neither"
		m_aryStopWords(197) = "never"
		m_aryStopWords(198) = "nevertheless"
		m_aryStopWords(199) = "next"
		m_aryStopWords(200) = "no"
		m_aryStopWords(201) = "nobody"
		m_aryStopWords(202) = "none"
		m_aryStopWords(203) = "nonetheless"
		m_aryStopWords(204) = "noone"
		m_aryStopWords(205) = "nor"
		m_aryStopWords(206) = "nos"
		m_aryStopWords(207) = "not"
		m_aryStopWords(208) = "noted"
		m_aryStopWords(209) = "nothing"
		m_aryStopWords(210) = "now"
		m_aryStopWords(211) = "nowhere"
		m_aryStopWords(212) = "obtain"
		m_aryStopWords(213) = "obtained"
		m_aryStopWords(214) = "of"
		m_aryStopWords(215) = "off"
		m_aryStopWords(216) = "often"
		m_aryStopWords(217) = "on"
		m_aryStopWords(218) = "once"
		m_aryStopWords(219) = "one"
		m_aryStopWords(220) = "only"
		m_aryStopWords(221) = "onto"
		m_aryStopWords(222) = "or"
		m_aryStopWords(223) = "other"
		m_aryStopWords(224) = "others"
		m_aryStopWords(225) = "otherwise"
		m_aryStopWords(226) = "ought"
		m_aryStopWords(227) = "our"
		m_aryStopWords(228) = "ours"
		m_aryStopWords(229) = "ourselves"
		m_aryStopWords(230) = "out"
		m_aryStopWords(231) = "over"
		m_aryStopWords(232) = "overall"
		m_aryStopWords(233) = "owing"
		m_aryStopWords(234) = "own"
		m_aryStopWords(235) = "part"
		m_aryStopWords(236) = "particularly"
		m_aryStopWords(237) = "parts"
		m_aryStopWords(238) = "past"
		m_aryStopWords(239) = "per"
		m_aryStopWords(240) = "perhaps"
		m_aryStopWords(241) = "please"
		m_aryStopWords(242) = "possibly"
		m_aryStopWords(243) = "predominantly"
		m_aryStopWords(244) = "previously"
		m_aryStopWords(245) = "probably"
		m_aryStopWords(246) = "prompt"
		m_aryStopWords(247) = "promptly"
		m_aryStopWords(248) = "quite"
		m_aryStopWords(249) = "rather"
		m_aryStopWords(250) = "ready"
		m_aryStopWords(251) = "really"
		m_aryStopWords(252) = "regardless"
		m_aryStopWords(253) = "relatively"
		m_aryStopWords(254) = "respectively"
		m_aryStopWords(255) = "said"
		m_aryStopWords(256) = "same"
		m_aryStopWords(257) = "seem"
		m_aryStopWords(258) = "seemed"
		m_aryStopWords(259) = "seeming"
		m_aryStopWords(260) = "seemingly"
		m_aryStopWords(261) = "seems"
		m_aryStopWords(262) = "seen"
		m_aryStopWords(263) = "set"
		m_aryStopWords(264) = "several"
		m_aryStopWords(265) = "shall"
		m_aryStopWords(266) = "she"
		m_aryStopWords(267) = "should"
		m_aryStopWords(268) = "show"
		m_aryStopWords(269) = "showed"
		m_aryStopWords(270) = "shown"
		m_aryStopWords(271) = "shows"
		m_aryStopWords(272) = "similar"
		m_aryStopWords(273) = "similarly"
		m_aryStopWords(274) = "since"
		m_aryStopWords(275) = "slightly"
		m_aryStopWords(276) = "so"
		m_aryStopWords(277) = "some"
		m_aryStopWords(278) = "somehow"
		m_aryStopWords(279) = "someone"
		m_aryStopWords(280) = "something"
		m_aryStopWords(281) = "sometime"
		m_aryStopWords(282) = "sometimes"
		m_aryStopWords(283) = "somewhat"
		m_aryStopWords(284) = "somewhere"
		m_aryStopWords(285) = "soon"
		m_aryStopWords(286) = "still"
		m_aryStopWords(287) = "strongly"
		m_aryStopWords(288) = "substantially"
		m_aryStopWords(289) = "successfully"
		m_aryStopWords(290) = "such"
		m_aryStopWords(291) = "than"
		m_aryStopWords(292) = "that"
		m_aryStopWords(293) = "that'll"
		m_aryStopWords(294) = "the"
		m_aryStopWords(295) = "their"
		m_aryStopWords(296) = "theirs"
		m_aryStopWords(297) = "them"
		m_aryStopWords(298) = "themselves"
		m_aryStopWords(299) = "then"
		m_aryStopWords(300) = "thence"
		m_aryStopWords(301) = "thenceforth"
		m_aryStopWords(302) = "there"
		m_aryStopWords(303) = "thereafter"
		m_aryStopWords(304) = "thereby"
		m_aryStopWords(305) = "therefor"
		m_aryStopWords(306) = "therefore"
		m_aryStopWords(307) = "therein"
		m_aryStopWords(308) = "thereupon"
		m_aryStopWords(309) = "these"
		m_aryStopWords(310) = "they"
		m_aryStopWords(311) = "this"
		m_aryStopWords(312) = "those"
		m_aryStopWords(313) = "though"
		m_aryStopWords(314) = "through"
		m_aryStopWords(315) = "throughout"
		m_aryStopWords(316) = "thus"
		m_aryStopWords(317) = "to"
		m_aryStopWords(318) = "together"
		m_aryStopWords(319) = "too"
		m_aryStopWords(320) = "took"
		m_aryStopWords(321) = "toward"
		m_aryStopWords(322) = "towards"
		m_aryStopWords(323) = "under"
		m_aryStopWords(324) = "unless"
		m_aryStopWords(325) = "unlike"
		m_aryStopWords(326) = "unlikely"
		m_aryStopWords(327) = "until"
		m_aryStopWords(328) = "up"
		m_aryStopWords(329) = "upon"
		m_aryStopWords(330) = "us"
		m_aryStopWords(331) = "use"
		m_aryStopWords(332) = "used"
		m_aryStopWords(333) = "usefully"
		m_aryStopWords(334) = "using"
		m_aryStopWords(335) = "usually"
		m_aryStopWords(336) = "various"
		m_aryStopWords(337) = "very"
		m_aryStopWords(338) = "via"
		m_aryStopWords(339) = "want"
		m_aryStopWords(340) = "was"
		m_aryStopWords(341) = "way"
		m_aryStopWords(342) = "we"
		m_aryStopWords(343) = "well"
		m_aryStopWords(344) = "were"
		m_aryStopWords(345) = "what"
		m_aryStopWords(346) = "whatever"
		m_aryStopWords(347) = "whatsoever"
		m_aryStopWords(348) = "when"
		m_aryStopWords(349) = "whence"
		m_aryStopWords(350) = "whenever"
		m_aryStopWords(351) = "whensoever"
		m_aryStopWords(352) = "where"
		m_aryStopWords(353) = "whereafter"
		m_aryStopWords(354) = "whereas"
		m_aryStopWords(355) = "whereat"
		m_aryStopWords(356) = "whereby"
		m_aryStopWords(357) = "wherefrom"
		m_aryStopWords(358) = "wherein"
		m_aryStopWords(359) = "whereinto"
		m_aryStopWords(360) = "whereof"
		m_aryStopWords(361) = "whereon"
		m_aryStopWords(362) = "whereto"
		m_aryStopWords(363) = "whereunto"
		m_aryStopWords(364) = "whereupon"
		m_aryStopWords(365) = "wherever"
		m_aryStopWords(366) = "wherewith"
		m_aryStopWords(367) = "whether"
		m_aryStopWords(368) = "which"
		m_aryStopWords(369) = "whichever"
		m_aryStopWords(370) = "while"
		m_aryStopWords(371) = "whilst"
		m_aryStopWords(372) = "whither"
		m_aryStopWords(373) = "who"
		m_aryStopWords(374) = "whoever"
		m_aryStopWords(375) = "whole"
		m_aryStopWords(376) = "whom"
		m_aryStopWords(377) = "whomever"
		m_aryStopWords(378) = "whomsoever"
		m_aryStopWords(379) = "whose"
		m_aryStopWords(380) = "whosoever"
		m_aryStopWords(381) = "why"
		m_aryStopWords(382) = "widely"
		m_aryStopWords(383) = "will"
		m_aryStopWords(384) = "with"
		m_aryStopWords(385) = "within"
		m_aryStopWords(386) = "without"
		m_aryStopWords(387) = "would"
		m_aryStopWords(388) = "yes"
		m_aryStopWords(389) = "yet"
		m_aryStopWords(390) = "you"
		m_aryStopWords(391) = "your"
		m_aryStopWords(392) = "yours"
		m_aryStopWords(393) = "yourself"
		m_aryStopWords(394) = "yourselves"
	End Sub

End Class
%>